import os
import shutil


def copiar_archivos(casos, ruta_original, ruta_destino, set_type="train"):
    for caso in casos:
        # Crear estructura de carpetas en el nuevo dataset
        os.makedirs(os.path.join(ruta_destino, set_type, "labels"), exist_ok=True)
        os.makedirs(
            os.path.join(
                ruta_destino,
                set_type,
                "images",
                "images_DSC",
                f"UPENN-GBM-{str(caso).zfill(5)}_11",
            ),
            exist_ok=True,
        )
        os.makedirs(
            os.path.join(
                ruta_destino,
                set_type,
                "images",
                "images_DTI",
                f"UPENN-GBM-{str(caso).zfill(5)}_11",
            ),
            exist_ok=True,
        )
        os.makedirs(
            os.path.join(
                ruta_destino,
                set_type,
                "images",
                "images_structural",
                f"UPENN-GBM-{str(caso).zfill(5)}_11",
            ),
            exist_ok=True,
        )

        # Copiar archivos de automated_segm a ./train/labels
        archivo_segm_origen = (
            f"UPENN-GBM-{str(caso).zfill(5)}_11_automated_approx_segm.nii.gz"
        )
        archivo_segm_destino = os.path.join(
            ruta_destino, set_type, "labels", archivo_segm_origen
        )
        shutil.copy2(
            os.path.join(ruta_original, "automated_segm", archivo_segm_origen),
            archivo_segm_destino,
        )
        print(f"Copiando {archivo_segm_origen} a {archivo_segm_destino}")

        # Copiar archivos de images_DSC, images_DTI, images_structural a ./train/images
        carpetas = ["images_DSC", "images_DTI", "images_structural"]
        for carpeta in carpetas:
            carpeta_origen = os.path.join(
                ruta_original, f"{carpeta}", f"UPENN-GBM-{str(caso).zfill(5)}_11"
            )
            carpeta_destino = os.path.join(
                ruta_destino,
                set_type,
                "images",
                carpeta,
                f"UPENN-GBM-{str(caso).zfill(5)}_11",
            )

            for archivo in os.listdir(carpeta_origen):
                if not archivo.endswith("_DSC.nii.gz"):
                    archivo_origen = os.path.join(carpeta_origen, archivo)
                    archivo_destino = os.path.join(carpeta_destino, archivo)
                    shutil.copy2(archivo_origen, archivo_destino)
                    print(f"Copiando {archivo} a {archivo_destino}")


# Definir casos y rutas
# Automáticos
casos = [
    12,
    22,
    23,
    34,
    38,
    47,
    57,
    58,
    63,
    64,
    65,
    68,
    71,
    72,
    77,
    78,
    81,
    85,
    87,
    89,
    98,
    123,
    125,
    126,
    127,
    132,
    152,
    157,
    161,
    162,
    163,
    164,
    165,
    167,
    168,
    169,
    170,
    171,
    175,
    177,
    185,
    187,
    188,
    190,
    191,
    194,
    195,
    198,
    203,
    204,
    207,
    210,
    213,
    216,
    224,
    225,
    229,
    232,
    234,
    236,
    237,
    242,
    243,
    244,
    246,
    248,
    250,
    255,
    258,
    263,
    265,
    268,
    269,
    271,
    276,
    282,
    287,
    288,
    291,
    296,
    300,
    303,
    304,
    305,
    308,
    310,
    313,
    315,
    316,
    323,
    324,
    325,
    328,
    334,
    335,
    336,
    337,
    338,
    340,
    342,
    345,
    346,
    348,
    349,
    350,
    363,
    364,
    365,
    369,
    370,
    374,
    377,
    378,
    379,
    382,
    385,
    387,
    389,
    392,
    395,
    397,
    399,
    403,
    405,
    406,
    407,
    408,
    409,
    411,
    412,
    413,
    416,
    417,
    419,
    420,
    421,
    423,
    425,
    426,
    427,
    431,
    432,
    434,
    435,
    436,
    442,
    443,
    444,
    445,
    446,
    448,
    449,
    451,
    453,
    454,
    455,
    456,
    457,
    458,
    459,
    460,
    461,
    462,
    463,
    464,
    465,
    466,
    467,
    468,
    469,
    470,
    471,
    472,
    473,
    475,
    476,
    477,
    490,
    491,
    496,
    499,
    504,
    508,
    510,
    513,
    514,
    516,
    518,
    519,
    520,
    523,
    526,
    527,
    528,
    529,
    530,
    533,
    534,
    535,
    538,
    539,
    540,
    541,
    545,
    546,
    549,
    550,
    551,
    552,
    554,
    556,
    559,
    560,
    561,
    564,
    565,
    566,
    567,
    568,
    569,
    572,
    575,
    576,
    577,
    578,
    581,
    582,
    583,
    588,
    590,
    592,
    594,
    595,
    596,
    597,
    599,
    600,
    601,
    602,
    604,
    605,
    606,
    607,
    608,
    611,
]  # Puedes modificar esta lista con los casos deseados
# Corregidos
casos = [
    22,
    81,
    132,
    188,
    237,
    271,
    324,
    345,
    377,
    405,
    420,
    446,
    461,
    490,
    527,
    539,
    560,
    581,
    597,
    605,
]
# Validacion
casos = [
    36,
    42,
    45,
    51,
    52,
    55,
    84,
    86,
    88,
    122,
    128,
    129,
    133,
    134,
    140,
    141,
    145,
    148,
    150,
    160,
    183,
    197,
    219,
    267,
    285,
    295,
    301,
    302,
    307,
    312,
    314,
    332,
    352,
    353,
    354,
    355,
]

ruta_dataset_original = "E:\\Download\\UPENN-GBM\\NIfTI-files"
ruta_dataset_destino = "E:\\Download\\UPENN-GBM\\Dataset_new"

# Llamar a la función de copia
copiar_archivos(casos, ruta_dataset_original, ruta_dataset_destino, set_type="test")
